<script type="text/javascript">

<!-- hide

var glbSessionKey = "<%ejGetOther(sessionKey)%>";

var maxSp = '<%ejGetVoice(maxSp)%>';                            // MaxProfileCount
var maxLines = '<%ejGetVoice(maxLines)%>';                      // MaxLineCount
if ( maxLines.search("ejGetVoice") >= 0 ) {
   maxLines = 2;                                                // if not provided by provisioning, hard-code maxLines
}
var currentSp = '<%ejGetVoice(numSp)%>';                        // current Profile count
var currentAcnt = '<%ejGetVoice(numLines)%>';                   // current sip accounts

var voiceRunning='<%ejGetVoice(voiceInUse)%>';

var tmplc = '<%ejGetVoice(linesPerVP)%>';                       // number of lines per profile
var tmpvpn = '<%ejGetVoice(VPName)%>';                          // SIP Service Provider Name
var tmplp = '<%ejGetVoice(localPort)%>';                        // SIP Local Port
var tmppa = '<%ejGetVoice(proxyAddr)%>';                        // SIP Server Address
var tmppp = '<%ejGetVoice(proxyPort)%>';                        // SIP Server Port
var tmpra = '<%ejGetVoice(regAddr)%>';                          // REGISTER Server Address
var tmprp = '<%ejGetVoice(regPort)%>';                          // REGISTER Server Port
var tmpuad  = '<%ejGetVoice(domainName)%>';                     // SIP Service Domain

var tmpst = '<%ejGetVoice(transport)%>';                        // Transport Type
var tmpdip = '<%ejGetVoice(IgnoreDirectIP)%>';                  // Ignore Direct IP

var transportList  = '<%ejGetVoice(transportList)%>';
var toktransportList = transportList.split(" ");
var ifList  = '<%ejGetVoice(ifList)%>';
var tokInterfaceList = ifList.split(" ");
var tmpboundIfList = '<%ejGetVoice(boundIfList)%>';
// Get Bound Interface ServiceName
var serverNameList  = '<%ejGetVoice(serviceNameList)%>';
var tokServerNameList = serverNameList.split(" ");
var forEircom  = '<%ejGetOther(sysInfo, forEircom)%>';
var forNorway  = '<%ejGetOther(sysInfo, forNorway)%>';
var customizationFlag = '<%ejGetOther(customizationFlag)%>'; //ZyXEL, Brady add for hide Register Re-send timer

for (var i = 0; i < currentSp; i++) {

	eval( "var lc" + i + " \= \"\" " );            /*line count per profile*/
	eval( "var vpn" + i + " \= \"\" " );           /*vpName*/
	eval( "var lp" + i + " \= \"\" " );            /*localPort*/
	eval( "var pa" + i + " \= \"\" " );            /*proxyAddr*/
	eval( "var pp" + i + " \= \"\" " );            /*proxyPort*/
	eval( "var ra" + i + " \= \"\" " );            /*regAddr*/
	eval( "var rp" + i + " \= \"\" " );            /*regPort*/
	eval( "var uad" + i + " \= \"\" " );           /*domainName*/ 
	eval( "var st" + i + " \= \"\" " );            /*transport*/
	eval( "var bil" + i + " \= \"\" " );           /*boundIfList*/
}


if ( tmplc.search("ejGetVoice") < 0 ){
	eval(tmplc);
}
if ( tmpvpn.search("ejGetVoice") < 0 ){
	eval(tmpvpn);
}
if ( tmplp.search("ejGetVoice") < 0 ){
	eval(tmplp);
}
if ( tmppa.search("ejGetVoice") < 0 ){
	eval(tmppa);
}
if ( tmppp.search("ejGetVoice") < 0 ){
	eval(tmppp);
}
if ( tmpra.search("ejGetVoice") < 0 ){
	eval(tmpra);
}
if ( tmprp.search("ejGetVoice") < 0 ){
	eval(tmprp);
}
if ( tmpuad.search("ejGetVoice") < 0 ){
	eval(tmpuad);
}
if ( tmpst.search("ejGetVoice") < 0 ){
	eval(tmpst);
}
if ( tmpboundIfList.search("ejGetVoice") < 0 ){
	eval(tmpboundIfList);
}


/* default profile setting */

var deflc = 1;
var defvpn = "changeme";                    // SIP Service Provider Name
var deflp = 5060;                           // SIP Local Port
var defpa = "changeme";                     // SIP Server Address
var defpp = 5060;                           // SIP Server Port
var defra = "changeme";                     // REGISTER Server Address
var defrp = 5060;                           // REGISTER Server Port
var defuad  = "changeme";                   // SIP Service Domain
var defs3263 = 0;                           // Support Locating SIP Server (RFC 3263)
var defs3262 = 0;                           // RFC 3262 (Require: 100rel)
var defvi = 13;                             // VoIP IOP Flags
var defifn  = "Any_WAN";                    // Bound Interface Name
var defoa = '';                             // Outbound Proxy Address
var defop = 5060;                           // Outbound Proxy Port
var defoa120 = 0;                           // Outbound Proxy Address for DHCP option 120 __ZyXEL__, Albert, 20131216
var defrpmi  = 51000;                       // RTP Port Range, Start Port 
var defrpmx  = 65500;                       // RTP Port Range, End Port
var defsrtpe = 0;                           // SRTP Support
var defsrtpcs = 'AES_CM_128_HMAC_SHA1_80';  // Crypto Suite
var defdt = "RFC2833";                      // DTMF Mode
var defst = "UDP";                          // Transport Type
var dedip =  0;                             // Ignore direct IP
var deffm = 'T38Relay';						// FAX Option, Disable , G711PassThrough , T38Relay
var defft  = 1;                             // FAX Option, G.711 Fax Passthrough 
var deft38  = 0;                            // FAX Option, T.38 Fax Relay 
var deffc  = 'pcma';                        // FAX Option, Fax Passthrough Codec 
if(forEircom)
{
var defts  = 46;                            // QoS Tag, SIP DSCP Mark Setting 
var deftr  = 46;                            // QoS Tag, RTP DSCP Mark Setting
}
else
{
var defts  = 40;                            // QoS Tag, SIP DSCP Mark Setting 
var deftr  = 40;                            // QoS Tag, RTP DSCP Mark Setting
}
var defre  = 3600;                          // Timer Setting, Expiration Duration
var defri  = 1800;                          // Timer Setting, Register Re-send timer
var defie  = 180;                           // Timer Setting, Session Expires
var defms  = 120;                           // Timer Setting, Min-SE
// *** Phone Key Config Start ***
var defphcfgcr = '*66#';                    // Call Return
//cathy add for caller id hidden/display call
var dfphcfgclird = '#31#'					// Caller ID Display Call
var dfphcfgclira = '*31#'                   // Caller ID Hidden Call 
var defphcfgcaa = '*82';                    // One Shot Caller Display Call
var defphcfgcad = '*67';                    // One Shot Caller Hidden Call
if ('<%ejGetOther(customer)%>' == 'Fullrate')
{
	var defphcfgcaa = '*30*';                    // One Shot Caller Display Call
	var defphcfgcad = '#30#';                    // One Shot Caller Hidden Call
}
var defphcfgcwa = '*41#';                   // Call Waiting Enable
var defphcfgcwd = '#41#';                   // Call Waiting Disable
var defphcfgivr = '****';                   // IVR
var defphcfginternal = '####';              // Internal Call
var defphcfgtransfer = '*98#';              // Call Transfer
var defphcfgcpa = '';                       // Call Park
var defphcfgcpr = '';                       // Call Park Retreive
var defphcfgcfua = '*22#';                  // Unconditional Call Forward Enable
var defphcfgcfud = '#22#';                  // Unconditional Call Forward Disable
if ('<%ejGetOther(customer)%>' == 'Fullrate')
{
	var defphcfgcfua = '*21*';                  // Unconditional Call Forward Enable
	var defphcfgcfud = '#21#';                  // Unconditional Call Forward Disable

}
var defphcfgcfnra = '*23#';                 // No Answer Call Forward Enable
var defphcfgcfnrd = '#23#';                 // No Answer Call Forward Disable
var defphcfgcfba = '*24#';                  // Call Forward When Busy Enable
var defphcfgcfbd = '#24#';                  // Call Forward When Busy Disable
var defphcfgoscwa = '*85';                  // One Shot Call Waiting Enable
var defphcfgoscwd = '*70';                  // One Shot Call Waiting Disable
var defphcfgdnde = '*95#';                  // Do Not Disturb Enable
var defphcfgdndd = '#95#';                  // Do Not Disturb Disable
var defphcfgccbsd = '#37#';                 // Call Completion on Busy Subscriber (CCBS) Deactivate
var defphcfgos = '#12';                     // Outgoing SIP
// *** Phone Key Config End ***
var defdme  = 0;                            // Dial Plan Enable
var defdm  = '';                            // Dial Plan
var defdialint = 3;                         // Dialing Interval Selection
var defpe  = 0;                             // Immediate Dial Enable

var defboundIfList = '';

/**************************************/

function hideMultiIf(){
	if(tokInterfaceList.length < 2) {
	} else if(tokInterfaceList.length == 2) {
		document.forms[0].multiIf.disabled = true;
	} else {
		for (i = 1; i < tokInterfaceList.length; i++) {
			document.forms[0].multiIf[i-1].disabled = true;
		}
	}
}

function showMultiIf(){
	if(tokInterfaceList.length < 2) {
	} else if(tokInterfaceList.length == 2) {
		document.forms[0].multiIf.disabled = false;
	} else {
		for (i = 1; i < tokInterfaceList.length; i++) {
			document.forms[0].multiIf[i-1].disabled = false;
		}
	}
}

function updateTransportList(){
	var SPSelect = document.getElementById("SPSelect").value;
	for(i=0;i<toktransportList.length;i++){
		document.forms[0].sipTransport.options[i] = new Option(toktransportList[i],toktransportList[i]);
		if(SPSelect < parseInt(currentSp)){
			if(document.forms[0].sipTransport.options[i].value == eval("st"+ SPSelect )){
				document.forms[0].sipTransport.options[i].selected = true;
			}
		}else{
			if(document.forms[0].sipTransport.options[i].value == defst){
				document.forms[0].sipTransport.options[i].selected = true;	
			}					
		}
	}
	if(document.getElementById("support3263").checked == true){
		document.forms[0].sipTransport.options[parseInt(toktransportList.length)] = new Option('AUTO','Auto');			
		document.forms[0].sipTransport.length = parseInt(toktransportList.length) + 1;			
	}else{
		document.forms[0].sipTransport.length = toktransportList.length;		
	}
}

function rfc3263_showPort(){
	if(document.getElementById("support3263").checked == true){
		document.getElementById("proxy_Port").disabled = true;
		document.getElementById("reg_Port").disabled = true;		
	}else{
		document.getElementById("proxy_Port").disabled = false;
		document.getElementById("reg_Port").disabled = false;		
	}
	updateTransportList();
}

function printInterfaceListBox(){
	var inBoundIfList = 0;
	var j =  document.getElementById("SPSelect").value; 	
	var tmplist = '';
	var boundInterfaces = '';
	var str = '';
	if(j < parseInt(currentSp)){
		boundInterfaces = eval("bil" + j + ".split('|')");
	}

	for(i = 1; i < tokInterfaceList.length; i++)
	{
		inBoundIfList = 0;
		for(j = 0; j < boundInterfaces.length; j++)
		{		
			if( tokInterfaceList[i] == boundInterfaces[j] ) {
				inBoundIfList = 1;
				break;
			}
		}
		
		if(inBoundIfList == 1) {
			str += " <input type='checkbox' name='multiIf' checked value=" + tokInterfaceList[i] + '>' + tokServerNameList[i] ;
			$('#ifNameTable').append(str);
		} else {
			str += " <input type='checkbox' name='multiIf' value=" + tokInterfaceList[i] + '>' + tokServerNameList[i] ;
			$('#ifNameTable').append(str);
		}
		str = '';
	}

	if(document.forms[0].if_Name[0].checked == true){
		hideMultiIf();
	} else if(document.forms[0].if_Name[1].checked == true){
		hideMultiIf();
	} else{
		showMultiIf();				
	}		  

}

function printSPSelectList(){
	var addNewIdx ; 
	var i = 0;

	$('#SPSelect').empty();

	for (i = 0; i < currentSp; i++) {
		addNewIdx = i + 1;
		vpname = eval('vpn'+i) ;
		if (i == 0){
			$('#SPSelect').append('<option value='+i+' selected>'+vpname+'</option>'); 	
		}else{
			$('#SPSelect').append('<option value='+i+' >'+vpname+'</option>'); 
		}
	}
	if( parseInt(currentSp) < parseInt(maxSp) && parseInt(currentAcnt)<parseInt(maxLines)){
		$('#SPSelect').append('<option value='+addNewIdx+' >ADD_NEW</option>'); 
	}	
}

function chkPortRange(portvalue,i)
{
	if (i == 'local_Port'){
		if (portvalue > 65535 || portvalue < 1030 || (portvalue > 9980 && portvalue < 14097))
		{alert("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str2)%>");
				sipLogPort.value = 5060;
				sipLogPort.focus();
		}
	}
	else if (i == 'proxy_Port'){
		if (portvalue > 65535 || portvalue < 1)
		{
			alert("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str3)%>");
			proxy_Port.value = 5060;
			proxy_Port.focus();
		}
	}		
	else if (i == 'reg_Port'){
		if (portvalue > 65535 || portvalue < 1)
		{
			alert("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str3)%>");
			reg_Port.value = 5060;
			reg_Port.focus();
		}
	}		
}

function checkPhoneConfigKey(phcfgarray, phcfg, namestr){
	var key = phcfg.value;	
	var j;
	if(key.length>0){		
		if(key.substr(0,1) == '*' || key.substr(0,1)=='#'){
			for(i=0; i< phcfgarray.length; i++){
				if(phcfgarray[i] == key){
					alert(MLG_Makestring("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str4)%>", namestr, key));
					return false;
				}
			}
			
			for(i=1;i<10;i++){
				if(key == '#0'+i || key == '#10'){
					alert(MLG_Makestring("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str5)%>", namestr, key));
					return false;
				}
			}
		
			phcfgarray[phcfgarray.length] = key;
			return true;
		}
	}	
	return true;
}

function checkchars(field, maxchar) {
	//var strtmp = field.value.replace(/[\r\n]/g,'');
	//alert( strtmp + " hello!");
	if (field.value.length > maxchar) {
		alert(MLG_Makestring("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str6)%>", maxchar));
		field.focus();
		return false;
	}
	return true;  
}

function hideFaxPassthroughCodec(hide) {
	var status = 'visible';

	if ( hide == 1 )
		status = 'hidden';
	if (document.getElementById)  // DOM3 = IE5, NS6
		document.getElementById('faxcodec').style.visibility = status;
	else {
		if (document.layers == false) // IE4
			document.all.faxcodec.style.visibility = status;
	}
}

function frmLoad() {

	//var SP_Select = document.forms[0].SPSelect.value;
	//var boundInterfaces = '';
	with ( document.forms[0] ) {
		
		// Service Provider Selection
		//SPSelect.options[0] = new Option("ADD_NEW", currentSp);
		document.getElementById("SPSelect").innerHTML = "ADD_NEW";
		document.getElementById("SPSelect").value = currentSp;
		
		// General
		VP_Name.value = defvpn;         // SIP Service Provider Name
		local_Port.value = deflp;       // SIP Local Port
		proxy_Addr.value = defpa;       // SIP Server Address
		proxy_Port.value = defpp;       // SIP Server Port
		reg_Addr.value = defra;         // REGISTER Server Address
		reg_Port.value = defrp;         // REGISTER Server Port
		domain_Name.value = defuad;     // SIP Service Domain

		// brady, 20150720 ,Modify re-transmission behavior for TIM
		if ( (customizationFlag & 0x00100000)){
			document.getElementById("reg_RetryInt").disabled = true;	
		}

		// brady,20150722 ,disable session refresh for TIM
		if ( (customizationFlag & 0x00200000)){
			document.getElementById("invite_ExpTmr").disabled = true;
			document.getElementById("min_SE").disabled = true;
		}
		
		// Support Locating SIP Server (RFC 3263)
		if (defs3263 == 1){
			support3263.checked = true;
		}    
		else{
			support3263.checked = false;		
		}

		// RFC 3262 (Require: 100rel)
		if( defs3262 == 1){
			support3262.checked = true;
		}
		else{
			support3262.checked = false;
		}
		
		if (forNorway == '1'){
			document.getElementById("select3262").style.display='none';
			document.getElementById("cfgForNorway").value="yes";
		}
		else{
			document.getElementById("cfgForNorway").value="no";
		}
		
		// VoIP IOP Flags
		for(i=0;i<voip_iop.length;i++){
			if(defvi & (1<<i)){
				voip_iop[i].checked = true;
			}
		}
		
		// Bound Interface Name
		if(defifn == 'LAN'){
			if_Name[0].checked = true;
		} else if(defifn == 'Any_WAN'){
			if_Name[1].checked = true;
		} else{
			if_Name[2].checked = true;
		}

		// Outbound Proxy
		obProxy_Addr.value = defoa;
		obProxy_Port.value = defop;	
		
		// __ZyXEL__, Albert, 20131216, for DHCP option 120  
		if (defoa120 == 1){
			obProxy_Addr_op120.checked = true;
		}    
		else{
			obProxy_Addr_op120.checked = false;		
		}
		
		// RTP Port Range
		rtp_PortMin.value = defrpmi;
		rtp_PortMax.value = defrpmx;
		
		// SRTP Support
		if(defsrtpe == 1){
			supportSRTP.checked = true;
		}
		else{
			supportSRTP.checked = false;
		}
		SRTPCryptoSuite.value = defsrtpcs;

		// DTMF Mode
		for(i=0; i<dtmf_Relay.length; i++){
			if(dtmf_Relay.options[i].value == defdt){
				dtmf_Relay.options[i].selected = true;         	 
			}
		}
		
		// Transport Type
		for(i=0;i<toktransportList.length;i++){
			sipTransport.options[i] = new Option(toktransportList[i],toktransportList[i]);
			if(sipTransport.options[i].value == defst){
				sipTransport.options[i].selected = true;
			}
		}			 
		if(defs3263 == 1){
			sipTransport.options[parseInt(sipTransport.length)] = new Option('AUTO','Auto');			
			sipTransport.length = parseInt(sipTransport.length) + 1;			
		}

		//Ignore Direct IP
		if (dedip == 1){
			VoIP_IgnoreDirectIP[0].checked =true;
			VoIP_IgnoreDirectIP[1].checked =false;
		}else{
			VoIP_IgnoreDirectIP[0].checked =false;
			VoIP_IgnoreDirectIP[1].checked =true;
		}
 

		// FAX Option
		/*if (deft38 == 1){
			VoIP_FaxRelay[0].checked = false;
			VoIP_FaxRelay[1].checked = true;
			hideFaxPassthroughCodec(1);
		}    
		else{
			VoIP_FaxRelay[0].checked = true;
			VoIP_FaxRelay[1].checked = false;
			hideFaxPassthroughCodec(0);
			if(deffc == 'pcmu'){
				faxPassCodec[0].checked = true;
			}
			else{
				faxPassCodec[1].checked = true;
			}
		}*/
        // FAX Option , VoIP_FaxRelay[0] is Disable , VoIP_FaxRelay[1] is G711PassThrough , VoIP_FaxRelay[2] is T38Relay ,yushiuan 2014/10/24
		if (deffm == 'T38Relay' ){
			VoIP_FaxRelay[0].checked = false;
			VoIP_FaxRelay[1].checked = true;
			hideFaxPassthroughCodec(1);
		}    
		else if (deffm == 'G711PassThrough' ){
			VoIP_FaxRelay[0].checked = true;
			VoIP_FaxRelay[1].checked = false;
			hideFaxPassthroughCodec(0);	
			if(deffc == 'pcmu'){
				faxPassCodec[0].checked = true;
			}
			else{
				faxPassCodec[1].checked = true;
			}
		}
		/*else{
			VoIP_FaxRelay[0].checked = true;
			VoIP_FaxRelay[1].checked = false;
			VoIP_FaxRelay[2].checked = false;
			hideFaxPassthroughCodec(1);	
		}*/


		// QoS Tag
		tosByte_Sip.value = defts;
		tosByte_Rtp.value = deftr;

		// Timer Setting
		reg_ExpTmr.value = defre;
		reg_RetryInt.value = defri;
		invite_ExpTmr.value = defie;
		min_SE.value = defms;

		// *** Phone Key Config Start ***
		
		// Call Return
		if(defphcfgcr.indexOf('(null)')==-1){
			callReturn.value = defphcfgcr ;
		}
/*ZyXEL, Cathy, add for Caller ID Display/Hidden Call*/
		// One Shot Caller Display Call
		if(dfphcfgclird.indexOf('(null)')==-1){
			CallidDisplay.value = dfphcfgclird;
		}
		
		// Caller Hidden Call
		if(dfphcfgclira.indexOf('(null)')==-1){
			CallerHiddenCall.value =dfphcfgclira;
		}
/*ZyXEL, Cathy, add end*/
		// One Shot Caller Display Call
		if(defphcfgcaa.indexOf('(null)')==-1){
			oneShotCallidDisplay.value = defphcfgcaa;
		}
		
		// One Shot Caller Hidden Call
		if(defphcfgcad.indexOf('(null)')==-1){
			oneShotCallerHiddenCall.value =defphcfgcad;
		}
		
		// Call Waiting Enable
		if(defphcfgcwa.indexOf('(null)')==-1){
			CallWaitingEnable.value = defphcfgcwa;
		}
		
		// Call Waiting Disable
		if(defphcfgcwd.indexOf('(null)')==-1){
			CallWaitingDisable.value = defphcfgcwd;
		}
		
		// IVR
		if(defphcfgivr.indexOf('(null)')==-1){
			IVR.value = defphcfgivr;
		}
		
		// Internal Call
		if(defphcfginternal.indexOf('(null)')==-1){
			InternalCall.value = defphcfginternal;
		}
		
		// Call Transfer
		if(defphcfgtransfer.indexOf('(null)')==-1){
			CallTransfer.value = defphcfgtransfer;
		}
		
/*
		// Call Park
		if(defphcfgcpa.indexOf('(null)')==-1){
			CallPark.value = defphcfgcpa;
		}
		
		// Call Park Retreive
		if(defphcfgcpr.indexOf('(null)')==-1){
			CallParkRetreive.value = defphcfgcpr;
		}
*/
		
		// Unconditional Call Forward Enable
		if(defphcfgcfua.indexOf('(null)')==-1){
			unCallForwardEnable.value = defphcfgcfua;
		}
		
		// Unconditional Call Forward Disable
		if(defphcfgcfud.indexOf('(null)')==-1){
			unCallForwardDisable.value = defphcfgcfud;
		}
		
		// No Answer Call Forward Enable
		if(defphcfgcfnra.indexOf('(null)')==-1){
			noCallForwardEnable.value = defphcfgcfnra;
		}
		
		// No Answer Call Forward Disable
		if(defphcfgcfnrd.indexOf('(null)')==-1){
			noCallForwardDisable.value = defphcfgcfnrd;
		}
		
		// Call Forward When Busy Enable
		if(defphcfgcfba.indexOf('(null)')==-1){
			BusyCallForwardEnable.value = defphcfgcfba;
		}
		
		// Call Forward When Busy Disable
		if(defphcfgcfbd.indexOf('(null)')==-1){
			BusyCallForwardDisable.value = defphcfgcfbd;
		}
		
		// One Shot Call Waiting Enable
		if(defphcfgoscwa.indexOf('(null)')==-1){
			oneShotCallWaitingEnable.value = defphcfgoscwa;
		}
		
		// One Shot Call Waiting Disable
		if(defphcfgoscwd.indexOf('(null)')==-1){
			oneShotCallWaitingDisable.value = defphcfgoscwd;
		}
		
		// Do Not Disturb Enable
		if(defphcfgdnde.indexOf('(null)')==-1){
			dndenable.value = defphcfgdnde;
		}
		
		// Do Not Disturb Disable
		if(defphcfgdndd.indexOf('(null)')==-1){
			dnddisable.value = defphcfgdndd;
		}
		
		// Call Completion on Busy Subscriber (CCBS) Deactivate
		if(defphcfgccbsd.indexOf('(null)')==-1){
			ccbsDeactive.value = defphcfgccbsd;
		}
		// Outgoing SIP
		if(defphcfgos.indexOf('(null)')==-1){
			outgoingSip.value = defphcfgos;
		}
		
		// *** Phone Key Config End ***
		
		// Dial Plan
		if(defdme == 1){
			dialPlanEnable.checked = true;
		}
		else{
			dialPlanEnable.checked = false;
		}
		
		dialPlan.value = defdm;

		// Dialing Interval Selection
		for(i=0;i<dialingIntervalTime.length;i++){
			if(dialingIntervalTime.options[i].value == defdialint){
				dialingIntervalTime.options[i].selected = true;
			}
		}

		// Immediate Dial Enable
		if(defpe == 1){
			pound_Enable.checked = true;
		}
		else{
			pound_Enable.checked = false;
		}
	}
}


function btnSave() {

	if(formCheck() ==false){
		return;
	}
	
	var SP_Select = document.getElementById("SPSelect").value; 
	//var SP_Select = currentSp;	// SIP Service Provider, special for ADD_NEW

	if(parseInt(SP_Select) < parseInt(currentSp) ){
		document.forms[0].action.value = "start";
	}else{
		if( parseInt(currentSp) >= parseInt(maxSp) ){
			alert(MLG_Makestring("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str7)%>", maxchar));
			return;
		}else if( parseInt(currentAcnt) >= parseInt(maxLines) ){
			alert(MLG_Makestring("<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str8)%>", maxchar));
			return;
		}else{
			document.forms[0].action.value = "addSP";
		}
	}

	with ( document.forms[0] ) {
		// Session Key
		sessionKey.value = glbSessionKey;
		// SIP Service Provider Name
		VPName.value = VP_Name.value;
 		document.getElementById('VPName').name = "VPName" + SP_Select;
		// SIP Local Port
		localPort.value = local_Port.value;
 		document.getElementById('localPort').name = "localPort" + SP_Select;
		// SIP Server Address
		proxyAddr.value = proxy_Addr.value;
 		document.getElementById('proxyAddr').name = "proxyAddr" + SP_Select;
		// SIP Server Port
		proxyPort.value = proxy_Port.value;
 		document.getElementById('proxyPort').name = "proxyPort" + SP_Select;
		// REGISTER Server Address
		regAddr.value = reg_Addr.value;
 		document.getElementById('regAddr').name = "regAddr" + SP_Select;
		// REGISTER Server Port
		regPort.value = reg_Port.value;
 		document.getElementById('regPort').name = "regPort" + SP_Select;
		// SIP Service Domain
		domainName.value = domain_Name.value;
 		document.getElementById('domainName').name = "domainName" + SP_Select;

		// Support Locating SIP Server (RFC 3263) 
		if(support3263.checked == true){
			rfc3263support.value = 1;
			document.getElementById('rfc3263support').name = "rfc3263support" + SP_Select;
		}
		else{
			rfc3263support.value = 0;
			document.getElementById('rfc3263support').name = "rfc3263support" + SP_Select;
		}
		
		// RFC 3262 (Require: 100rel)
		if (support3262.checked == true){
			rfc3262support.value = "on";
			document.getElementById('rfc3262support').name = "rfc3262support" + SP_Select;
		}
		else {
			rfc3262support.value = "off";
			document.getElementById('rfc3262support').name = "rfc3262support" + SP_Select;
		} 
		
		// VoIP IOP Flags
		var iopflags=0;
		for(i=0;i<voip_iop.length;i++){
			if (voip_iop[i].checked == true){
				iopflags |= (1<<i);
			}
		}
		voipiop.value = iopflags; 
 		//document.getElementById('voipiop').name = "voipiop" + SP_Select;

		// Bound Interface Name
		if(if_Name[0].checked == true) {
			ifName.value = "LAN";
			document.getElementById('ifName').name = "ifName" + SP_Select;
			boundIfList.value = "";
			document.getElementById('boundIfList').name = "boundIfList" + SP_Select;
		} else if(if_Name[1].checked == true) {
			ifName.value = "Any_WAN";
			document.getElementById('ifName').name = "ifName" + SP_Select;
			boundIfList.value = "";
			document.getElementById('boundIfList').name = "boundIfList" + SP_Select;
		} else {
			ifName.value = "Multi_WAN";
			document.getElementById('ifName').name = "ifName" + SP_Select;
			var first = true;
			var str = '';
			if(tokInterfaceList.length < 2) {
			} else if(tokInterfaceList.length == 2) {
				if (multiIf.checked) {
					boundIfList.value = multiIf.value;
					document.getElementById('boundIfList').name = "boundIfList" + SP_Select;
					first = false;
				}
			} else {
				for (i = 1; i < tokInterfaceList.length; i++) {
					if (multiIf[i-1].checked) {
						if (!first) {
							boundIfList.value = boundIfList.value + '|' + multiIf[i-1].value;
							document.getElementById('boundIfList').name = "boundIfList" + SP_Select;
						} else {
							boundIfList.value = multiIf[i-1].value;
							document.getElementById('boundIfList').name = "boundIfList" + SP_Select;
						}
						first = false;
					}
				}
			}
			if(first) {
				alert('<%ejGetML(MLG_VoIP_SIPServiceProvider_AlertMsg_Str9)%>');
				return false;
			}
		}

		// Outbound Proxy Address
		obProxyAddr.value = obProxy_Addr.value;
 		document.getElementById('obProxyAddr').name = "obProxyAddr" + SP_Select;
		// Outbound Proxy Port
		obProxyPort.value = obProxy_Port.value;
 		document.getElementById('obProxyPort').name = "obProxyPort" + SP_Select;

		// __ZyXEL__, Albert, 20131216, for DHCP option 120  
		if(obProxy_Addr_op120.checked == true){
			obProxyOp120_Enable.value = 1;
			document.getElementById('obProxyOp120_Enable').name = "obProxyOp120_Enable" + SP_Select;
		}
		else{
			obProxyOp120_Enable.value = 0;
			document.getElementById('obProxyOp120_Enable').name = "obProxyOp120_Enable" + SP_Select;
		}

		// RTP Port Range
		rtpPortMin.value = rtp_PortMin.value;
 		document.getElementById('rtpPortMin').name = "rtpPortMin" + SP_Select;
		rtpPortMax.value = rtp_PortMax.value;
 		document.getElementById('rtpPortMax').name = "rtpPortMax" + SP_Select;

		// SRTP Support
		if(supportSRTP.checked == true){
			srtpEnable.value = 1;
			document.getElementById('srtpEnable').name = "srtpEnable" + SP_Select;
		}
		else{
			srtpEnable.value = 0;
			document.getElementById('srtpEnable').name = "srtpEnable" + SP_Select;
		}
		srtpCryptoSuiteName.value = SRTPCryptoSuite.value;
 		document.getElementById('srtpCryptoSuiteName').name = "srtpCryptoSuiteName" + SP_Select;

		// DTMF Mode
		dtmfRelay.value = dtmf_Relay.value;
 		document.getElementById('dtmfRelay').name = "dtmfRelay" + SP_Select;

		// Transport Type
		transport.value = sipTransport.value;
 		document.getElementById('transport').name = "transport" + SP_Select;

		// Ignore Direct IP
		if(VoIP_IgnoreDirectIP[0].checked == true){
			IgnoreDirectIP.value = 1;
 			document.getElementById('IgnoreDirectIP').name = "IgnoreDirectIP" + SP_Select;

 		}else{
			IgnoreDirectIP.value = 0;
 			document.getElementById('IgnoreDirectIP').name = "IgnoreDirectIP" + SP_Select;

 		}


		// FAX Option only disable just set t38Enable.value = "off" , faxPassThrough.value = "Disable" , else the capbility should be on or Force , yushiuan 2014/10/24
		if (VoIP_FaxRelay[1].checked == true){
			faxPassThrough.value = "Force";
			document.getElementById('faxPassThrough').name = "faxPassThrough" + SP_Select;
			t38Enable.value = "on";
			document.getElementById('t38Enable').name = "t38Enable" + SP_Select;
			faxMode.value = "T38Relay";
			document.getElementById('faxMode').name = "faxMode" + SP_Select;
		}
		else if (VoIP_FaxRelay[0].checked == true){
			faxPassThrough.value = "Force";
			document.getElementById('faxPassThrough').name = "faxPassThrough" + SP_Select;
			if(faxPassCodec[0].checked){
				faxCodec.value = faxPassCodec[0].value;
				document.getElementById('faxCodec').name = "faxCodec" + SP_Select;
			}
			else{
				faxCodec.value = faxPassCodec[1].value;
				document.getElementById('faxCodec').name = "faxCodec" + SP_Select;
			}
			t38Enable.value = "on";
			document.getElementById('t38Enable').name = "t38Enable" + SP_Select;
			faxMode.value = "G711PassThrough";
			document.getElementById('faxMode').name = "faxMode" + SP_Select;
		}
		/*else{
			faxPassThrough.value = "Disable";
			document.getElementById('faxPassThrough').name = "faxPassThrough" + SP_Select;
			t38Enable.value = "off";
			document.getElementById('t38Enable').name = "t38Enable" + SP_Select;
			faxMode.value = "Disable";
			document.getElementById('faxMode').name = "faxMode" + SP_Select;
		}*/

		// QoS Tag
		tosByteSip.value = tosByte_Sip.value;
 		document.getElementById('tosByteSip').name = "tosByteSip" + SP_Select;
		tosByteRtp.value = tosByte_Rtp.value;
 		document.getElementById('tosByteRtp').name = "tosByteRtp" + SP_Select;
		
		// Timer Setting
		regExpTmr.value = reg_ExpTmr.value;
 		document.getElementById('regExpTmr').name = "regExpTmr" + SP_Select;
		regRetryInt.value = reg_RetryInt.value;
 		document.getElementById('regRetryInt').name = "regRetryInt" + SP_Select;
		inviteExpTmr.value = invite_ExpTmr.value;
 		document.getElementById('inviteExpTmr').name = "inviteExpTmr" + SP_Select;
		minSE.value = min_SE.value;
 		document.getElementById('minSE').name = "minSE" + SP_Select;

		// *** Phone Key Config Start ***
		
		// Call Return
		phcfgkeyCallReturn.value = callReturn.value;
 		document.getElementById('phcfgkeyCallReturn').name = "phcfgkeyCallReturn" + SP_Select;
/* ZyXEL, Cathy, add for caller ID Hidden/Display call */ 		
 		// Caller ID Display Call
 		phcfgkeyCLIR_Disable.value = CallidDisplay.value;
 		document.getElementById('phcfgkeyCLIR_Disable').name = "phcfgkeyCLIR_Disable" + SP_Select; 		
 		// Caller ID Hidden Call
  		phcfgkeyCLIR_Active.value = CallerHiddenCall.value;
 		document.getElementById('phcfgkeyCLIR_Active').name = "phcfgkeyCLIR_Active" + SP_Select; 		
/* ZyXEL, Cathy, add end */ 		
		// One Shot Caller Display Call
		phcfgkeyCA_Active.value = oneShotCallidDisplay.value;
 		document.getElementById('phcfgkeyCA_Active').name = "phcfgkeyCA_Active" + SP_Select;
		// One Shot Caller Hidden Call
		phcfgkeyCA_Disable.value = oneShotCallerHiddenCall.value;
 		document.getElementById('phcfgkeyCA_Disable').name = "phcfgkeyCA_Disable" + SP_Select;
		// Call Waiting Enable
		phcfgkeyCW_Active.value = CallWaitingEnable.value;
 		document.getElementById('phcfgkeyCW_Active').name = "phcfgkeyCW_Active" + SP_Select;
		// Call Waiting Disable
		phcfgkeyCW_Deactive.value = CallWaitingDisable.value;
 		document.getElementById('phcfgkeyCW_Deactive').name = "phcfgkeyCW_Deactive" + SP_Select;
		// IVR
		phcfgkeyIVR.value = IVR.value;
 		document.getElementById('phcfgkeyIVR').name = "phcfgkeyIVR" + SP_Select;
		// Internal Call
		phcfgkeyInternal.value = InternalCall.value;
 		document.getElementById('phcfgkeyInternal').name = "phcfgkeyInternal" + SP_Select;
		// Call Transfer
		phcfgkeyTransfer.value = CallTransfer.value;
 		document.getElementById('phcfgkeyTransfer').name = "phcfgkeyTransfer" + SP_Select;	// add vpSelect info
/*
		// Call Park
		phcfgkeyCP_Active.value = CallPark.value;
 		document.getElementById('phcfgkeyCP_Active').name = "phcfgkeyCP_Active" + SP_Select;
		// Call Park Retreive
		phcfgkeyCP_Retreive.value = CallParkRetreive.value;
 		document.getElementById('phcfgkeyCP_Retreive').name = "phcfgkeyCP_Retreive" + SP_Select;
*/
		// Unconditional Call Forward Enable
		phcfgkeyCFU_Active.value = unCallForwardEnable.value;
 		document.getElementById('phcfgkeyCFU_Active').name = "phcfgkeyCFU_Active" + SP_Select;
		// Unconditional Call Forward Disable
		phcfgkeyCFU_Deactive.value = unCallForwardDisable.value;
 		document.getElementById('phcfgkeyCFU_Deactive').name = "phcfgkeyCFU_Deactive" + SP_Select;
		// No Answer Call Forward Enable
		phcfgkeyCFNR_Active.value = noCallForwardEnable.value;
 		document.getElementById('phcfgkeyCFNR_Active').name = "phcfgkeyCFNR_Active" + SP_Select;
		// No Answer Call Forward Disable
		phcfgkeyCFNR_Deactive.value = noCallForwardDisable.value;
 		document.getElementById('phcfgkeyCFNR_Deactive').name = "phcfgkeyCFNR_Deactive" + SP_Select;
		// Call Forward When Busy Enable
		phcfgkeyCFB_Active.value = BusyCallForwardEnable.value;
 		document.getElementById('phcfgkeyCFB_Active').name = "phcfgkeyCFB_Active" + SP_Select;
		// Call Forward When Busy Disable
		phcfgkeyCFB_Deactive.value = BusyCallForwardDisable.value;
 		document.getElementById('phcfgkeyCFB_Deactive').name = "phcfgkeyCFB_Deactive" + SP_Select;
		// One Shot Call Waiting Enable
		phcfgkeyOSCW_Active.value = oneShotCallWaitingEnable.value;
 		document.getElementById('phcfgkeyOSCW_Active').name = "phcfgkeyOSCW_Active" + SP_Select;
		// One Shot Call Waiting Disable
		phcfgkeyOSCW_Deactive.value = oneShotCallWaitingDisable.value;
 		document.getElementById('phcfgkeyOSCW_Deactive').name = "phcfgkeyOSCW_Deactive" + SP_Select;
		// Do Not Disturb Enable
		phcfgkeyDND_Enable.value = dndenable.value;
 		document.getElementById('phcfgkeyDND_Enable').name = "phcfgkeyDND_Enable" + SP_Select;
		// Do Not Disturb Disable
		phcfgkeyDND_Disable.value = dnddisable.value;
 		document.getElementById('phcfgkeyDND_Disable').name = "phcfgkeyDND_Disable" + SP_Select;
		// Call Completion on Busy Subscriber (CCBS) Deactivate
		phcfgkeyCCBS_Deactive.value = ccbsDeactive.value;
 		document.getElementById('phcfgkeyCCBS_Deactive').name = "phcfgkeyCCBS_Deactive" + SP_Select;
		// Outgoing SIP
		phcfgkeyOutgoingSip.value = outgoingSip.value;
 		document.getElementById('phcfgkeyOutgoingSip').name = "phcfgkeyOutgoingSip" + SP_Select;

		// *** Phone Key Config End ***

		// Dial Plan
		if (dialPlanEnable.checked == true){
			digiMapEnable.value = "on";
			document.getElementById('digiMapEnable').name = "digiMapEnable" + SP_Select;
		}
		else {
			digiMapEnable.value = "off";
			document.getElementById('digiMapEnable').name = "digiMapEnable" + SP_Select;
		}    
		digiMap.value = dialPlan.value;
 		document.getElementById('digiMap').name = "digiMap" + SP_Select;
		
		// Dialing Interval Selection
		dialInterDigit.value = dialingIntervalTime.value;
 		document.getElementById('dialInterDigit').name = "dialInterDigit" + SP_Select;

		// Immediate Dial Enable
		if (pound_Enable.checked == true){
			poundEnable.value = "on";
			document.getElementById('poundEnable').name = "poundEnable" + SP_Select;	// no need to add vpSelect info
		}
		else {
			poundEnable.value = "off";
			document.getElementById('poundEnable').name = "poundEnable" + SP_Select;	// no need to add vpSelect info
		} 

		submit();
		$('.ui-dialog-titlebar-close').trigger('click');
		$.openLoadingMask(1);
	}
}

$(function(){
$('#btn_wepmore').toggle(
	function(){
		$(this).html('less');
		$('#detailedInfo').slideDown(200);
		document.getElementById("local_Port").disabled = false;
		document.getElementById("proxy_Port").disabled = false;
		document.getElementById("reg_Port").disabled = false;
	}, function(){
		$(this).html('more...');
		$('#detailedInfo').slideUp(200);
		document.getElementById("local_Port").disabled = true;
		document.getElementById("proxy_Port").disabled = true;
		document.getElementById("reg_Port").disabled = true;
	});
});

var db = $('.popup_frame').parents('.dialogContener'); 
var ApplyBtn = db.parents('.ui-dialog').find('.ui-dialog-buttonpane').children('Button:nth-child(2)');
ApplyBtn.click(function(){ btnSave(); });

$(document).ready(function() {
	//resetMsg();
	//printSPSelectList();
	frmLoad();
});

// done hiding -->
</script>

<form id="SipServerAddForm" name="sipServerAddForm" method="post" action="/pages/tabFW/sip-voicesipcfg.cmd" target="mainFrame">

<input name="action" type="HIDDEN" id="action" value="view"; />
<input name="sessionKey" type="HIDDEN" id="sessionKey" value=""; />
<input name="spnum" type="HIDDEN" id="spnum" value=""; />

<input name="VPName" type="HIDDEN" id="VPName" value=""; />
<input name="localPort" type="HIDDEN" id="localPort" value=""; />
<input name="obProxyAddr" type="HIDDEN" id="obProxyAddr" value=""; />
<input name="obProxyPort" type="HIDDEN" id="obProxyPort" value=""; />

<!--  __ZyXEL__, Albert, 20131216, for DHCP option 120  -->
<input name="obProxyOp120_Enable" type="HIDDEN" id="obProxyOp120_Enable" value=""; />
 
<input name="proxyAddr" type="HIDDEN" id="proxyAddr" value=""; />
<input name="proxyPort" type="HIDDEN" id="proxyPort" value=""; />
<input name="regAddr" type="HIDDEN" id="regAddr" value=""; />
<input name="regPort" type="HIDDEN" id="regPort" value=""; />
<input name="domainName" type="HIDDEN" id="domainName" value=""; />
<input name="transport" type="HIDDEN" id="transport" value=""; />
<input name="IgnoreDirectIP" type="HIDDEN" id="IgnoreDirectIP" value=""; />
<input name="inviteExpTmr" type="HIDDEN" id="inviteExpTmr" value=""; />
<input name="regExpTmr" type="HIDDEN" id="regExpTmr" value=""; />
<input name="regRetryInt" type="HIDDEN" id="regRetryInt" value=""; />
<input name="rtpPortMin" type="HIDDEN" id="rtpPortMin" value=""; />
<input name="rtpPortMax" type="HIDDEN" id="rtpPortMax" value=""; />
<input name="dtmfRelay" type="HIDDEN" id="dtmfRelay" value=""; />
<input name="minSE" type="HIDDEN" id="minSE" value=""; />
<input name="digiMap" type="HIDDEN" id="digiMap" value=""; />
<input name="dialInterDigit" type="HIDDEN" id="dialInterDigit" value=""; />
<input name="rfc3263support" type="HIDDEN" id="rfc3263support" value=""; />
<input name="voipiop" type="HIDDEN" id="voipiop" value=""; />
<input name="srtpEnable" type="HIDDEN" id="srtpEnable" value=""; />
<input name="srtpCryptoSuiteName" type="HIDDEN" id="srtpCryptoSuiteName" value=""; />
<input name="faxMode" type="HIDDEN" id="faxMode" value=""; />
<input name="faxPassThrough" type="HIDDEN" id="faxPassThrough" value=""; />
<input name="t38Enable" type="HIDDEN" id="t38Enable" value=""; />
<input name="faxCodec" type="HIDDEN" id="faxCodec" value=""; />
<input name="tosByteSip" type="HIDDEN" id="tosByteSip" value=""; />
<input name="tosByteRtp" type="HIDDEN" id="tosByteRtp" value=""; />
<input name="ifName" type="HIDDEN" id="ifName" value=""; />
<input name="boundIfList" type="HIDDEN" id="boundIfList" value=""; />
<input name="rfc3262support" type="HIDDEN" id="rfc3262support" value=""; />
<input name="digiMapEnable" type="HIDDEN" id="digiMapEnable" value=""; />
<input name="poundEnable" type="HIDDEN" id="poundEnable" value=""; />
<input name="phcfgkeyCallReturn" type="HIDDEN" id="phcfgkeyCallReturn" value=""; />
<!-- ZyXEL, cathy add for caller id display/hidden call-->
<input name="phcfgkeyCLIR_Active" type="HIDDEN" id="phcfgkeyCLIR_Active" value=""; />
<input name="phcfgkeyCLIR_Disable" type="HIDDEN" id="phcfgkeyCLIR_Disable" value=""; />
<!-- ZyXEL, cathy add end-->
<input name="phcfgkeyCA_Active" type="HIDDEN" id="phcfgkeyCA_Active" value=""; />
<input name="phcfgkeyCA_Disable" type="HIDDEN" id="phcfgkeyCA_Disable" value=""; />
<input name="phcfgkeyIVR" type="HIDDEN" id="phcfgkeyIVR" value=""; />
<input name="phcfgkeyInternal" type="HIDDEN" id="phcfgkeyInternal" value=""; />
<input name="phcfgkeyTransfer" type="HIDDEN" id="phcfgkeyTransfer" value=""; />
<input name="phcfgkeyCW_Active" type="HIDDEN" id="phcfgkeyCW_Active" value=""; />
<input name="phcfgkeyCW_Deactive" type="HIDDEN" id="phcfgkeyCW_Deactive" value=""; />
<input name="phcfgkeyCFU_Active" type="HIDDEN" id="phcfgkeyCFU_Active" value=""; />
<input name="phcfgkeyCFU_Deactive" type="HIDDEN" id="phcfgkeyCFU_Deactive" value=""; />
<input name="phcfgkeyCFNR_Active" type="HIDDEN" id="phcfgkeyCFNR_Active" value=""; />
<input name="phcfgkeyCFNR_Deactive" type="HIDDEN" id="phcfgkeyCFNR_Deactive" value=""; />
<input name="phcfgkeyCFB_Active" type="HIDDEN" id="phcfgkeyCFB_Active" value=""; />
<input name="phcfgkeyCFB_Deactive" type="HIDDEN" id="phcfgkeyCFB_Deactive" value=""; />
<input name="phcfgkeyOSCW_Active" type="HIDDEN" id="phcfgkeyOSCW_Active" value=""; />
<input name="phcfgkeyOSCW_Deactive" type="HIDDEN" id="phcfgkeyOSCW_Deactive" value=""; />
<input name="phcfgkeyDND_Enable" type="HIDDEN" id="phcfgkeyDND_Enable" value=""; />
<input name="phcfgkeyDND_Disable" type="HIDDEN" id="phcfgkeyDND_Disable" value=""; />
<!--
<input name="phcfgkeyCP_Active" type="HIDDEN" id="phcfgkeyCP_Active" value=""; />
<input name="phcfgkeyCP_Retreive" type="HIDDEN" id="phcfgkeyCP_Retreive" value=""; />
-->
<input name="phcfgkeyCCBS_Deactive" type="HIDDEN" id="phcfgkeyCCBS_Deactive" value=""; />
<input name="phcfgkeyOutgoingSip" type="HIDDEN" id="phcfgkeyOutgoingSip" value=""; />
<input name="cfgForNorway" type="HIDDEN" id="cfgForNorway" value=""; />

<div class="popup_frame" >
<div class="data_frame">
	<ul>

		<li class="space"></li>

		<!--SIP Service Provider Selection START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str8)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str9)%> : </li>
						<li class="right_table">
							<span id="SPSelect" name="SPSelect" value=""></span>
						</li>
					</ul>
				</div>
			</li>
		<!--SIP Service Provider Selection END-->

		<li class="space"></li>	
		
		<!--General START-->
		<li class="set1">
			<div class="title"><%ejGetML(MLG_Common_General)%></div>
			<div class="w_text">
				<ul>
					<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str10)%> : </li>
					<li class="right_table">
						<input id="VP_Name" type="text" maxlength="63" name="VP_Name"/>
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str11)%> : </li>
					<li class="right_table">
						<input name="local_Port" type="text" id="local_Port" value="5060" onchange="javascript:rangeCheck(1025,65535,5060,this,1,1)" size="10" disabled="disabled"/><span >(1025-65535)</span>
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_ConnStatus_QuickStart_Str66)%></li>
					<li class="right_table">
						<input type="text" id="proxy_Addr" maxlength="63" name="proxy_Addr"/>
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str12)%> : </li>
					<li class="right_table">
						<input id="proxy_Port" name="proxy_Port" type="text" size="10" value="5060" onchange="javascript:rangeCheck(1025,65535,5060,this,1,1)" disabled="disabled"/><span >(1025-65535)</span>
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str3)%> : </li>
					<li class="right_table">
						<input type="text" id="reg_Addr" name="reg_Addr" maxlength="63" />
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str13)%> : </li>
					<li class="right_table">
						<input id="reg_Port" name="reg_Port" type="text" size="10" value="5060" onchange="javascript:rangeCheck(1025,65535,5060,this,1,1)" disabled="disabled"/><span >(1025-65535)</span>
					</li>
				</ul>
				<ul>
					<li class="left_table"><%ejGetML(MLG_ConnStatus_QuickStart_Str67)%></li>
					<li class="right_table">
						<input type="text" id="domain_Name" maxlength="63" name="domain_Name"/>
					</li>
				</ul>
			</div>
		</li>
		<!--General END-->
	
		<li>
<span class="linking moreBtn" id="btn_wepmore" style="float:right;"><%ejGetML(MLG_Common_more)%>...</span>
		</li>

		<li class="space"> </li>

		<div id='detailedInfo'  style="display:none; width:100%;">
			<!--RFC support START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str14)%></div>
				<div class="w_text">
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='support3263' id='support3263' onClick='rfc3263_showPort()'/> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str15)%> 
						</li>
					</ul>
					<ul id="select3262">
						<li class="all_table">
							<input type='checkbox' size="10" name='support3262' id='support3262' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str16)%>
						</li>
					</ul>
				</div>
			</li>
			<!--RFC support END-->

			<li class="space"></li>

			<!--VoIP IOP Flags START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str17)%></div>
				<div class="w_text">
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='voip_iop' id='voip_iop'/> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str18)%>
						</li>
					</ul>
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='voip_iop' id='voip_iop' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str19)%>
						</li>
					</ul>
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='voip_iop' id='voip_iop' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str20)%>
						</li>
					</ul>
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='voip_iop' id='voip_iop' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str21)%>
						</li>
					</ul>					
				</div>
			</li>
			<!--VoIP IOP Flags END-->

			<li class="space"></li>

			<!--Bound Interface Name START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str22)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str22)%> : </li>
						<li class="right_table" id="ifNameTable">
							<input name='if_Name' type='radio' onClick='hideMultiIf()' style="display: none"><a style="display: none">LAN</a>
							<input name='if_Name' type='radio' onClick='hideMultiIf()'>Any_WAN
							<input name='if_Name' type='radio' onClick='showMultiIf()'>Multi_WAN
							<script language="javascript">
								printInterfaceListBox()
							</script>
						</li>
					</ul>
				</div>
			</li>
			<!--Bound Interface Name END-->

			<li class="space"></li>

			<!--Outbound Proxy START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str23)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str24)%> : </li>
						<li class="right_table">
							<input type="text" id="obProxy_Addr" maxlength="63" name="obProxy_Addr"/>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str25)%> : </li>
						<li class="right_table">
							<input id="obProxy_Port" name="obProxy_Port" type="text" size="10" value="5060" onchange="javascript:rangeCheck(1025,65535,5060,this,1,1)" /><span class="hint">(1025-65535)</span>
						</li>
					</ul>

					<!--  __ZyXEL__, Albert, 20131216, for DHCP option 120  -->						
					<ul>
						<li class="left_table">
							<input type='checkbox' size="10" name='obProxy_Addr_op120' id='obProxy_Addr_op120' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str26)%>
						</li>
					</ul>					
				</div>
			</li>
			<!--Outbound Proxy END-->

			<li class="space"></li>			
			
			<!--RTP Port Range START-->
			<li class="set1" >
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str27)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_NAT_Applications_Str144)%>: </li>
						<li class="right_table">
							<input id="rtp_PortMin" name="rtp_PortMin" type="text"  size="10" onchange="javascript:rangeCheck(1026,65494,51000,this,1,1)"/><span class="hint">(1026-65494)</span>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_NAT_Applications_Str145)%>: </li>
						<li class="right_table">
							<input id="rtp_PortMax" name="rtp_PortMax" type="text" size="10" onchange="javascript:rangeCheck(1032,65500,65500,this,1,1)"/><span class="hint">(1032-65500)</span>
						</li>
					</ul>
				</div>
			</li>
			<!--RTP Port Range END-->
			
			<li class="space"></li>
			
			<!--SRTP Support START-->
			<li class="set1" >
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str28)%></div>
				<div class="w_text">
					<ul>
						<li class="all_table">
							<input type='checkbox' size="10" name='supportSRTP' id='supportSRTP' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str28)%>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str29)%> : </li>
						<li class="right_table">
							<select id="SRTPCryptoSuite" name="SRTPCryptoSuite">
								<option value="AES_CM_128_HMAC_SHA1_80" selected>AES_CM_128_HMAC_SHA1_80</option>
								<option value="AES_CM_128_HMAC_SHA1_32">AES_CM_128_HMAC_SHA1_32</option>
								<option value="AES_CM_128_NULL">AES_CM_128_NULL</option>
								<option value="NULL_CIPHER_HMAC_SHA1_80">NULL_CIPHER_HMAC_SHA1_80</option>
							</select>
							<span class="hint"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str30)%></span>
						</li>
					</ul>
				</div>
			</li>
			<!--SRTP Support END-->

			<li class="space"></li>

			<!--DTMF Mode START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str31)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str31)%> : </li>
						<li class="right_table">
							<select id="dtmf_Relay" name="dtmf_Relay">
								<option value="RFC2833" selected>RFC2833</option>
								<option value="InBand">InBand</option>
								<option value="SIPInfo">SIPInfo</option>
							</select>
						</li>
					</ul>
				</div>
			</li>
			<!--DTMF Mode END-->
			
			<li class="space"></li>

			<!--Transport Type START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str32)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str32)%> : </li>
						<li class="right_table">
							<select id="sipTransport" name="sipTransport">
								<option value="UDP" selected><%ejGetML(MLG_Common_UDP)%></option>
								<option value="TCP"><%ejGetML(MLG_Common_TCP)%></option>                  			  
							</select>
						</li>
					</ul>
				</div>
			</li>
			<!--Transport Type END-->
			
			<li class="space"></li>

			<!--Ignore Direct IP START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str33)%> </div>
				<div class="w_text">
					<ul>
						<li class="left_table">
							<input type="radio" name="VoIP_IgnoreDirectIP" value="0"><%ejGetML(MLG_Common_Enable)%>
						</li>
						<li class="right_table">
							<input type="radio" name="VoIP_IgnoreDirectIP" value="1"><%ejGetML(MLG_Common_Disable)%>
						</li>
					</ul>
				</div>
			</li>
			<!--Ignore Direct IP END-->
			
			<li class="space"></li>

			<!--FAX Option START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str34)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table">
							<input type="radio" name="VoIP_FaxRelay" value="0" onclick='hideFaxPassthroughCodec(0)'><%ejGetML(MLG_VoIP_SIPServiceProvider_Str35)%>
						</li>
						<li class="right_table">
							<input type="radio" name="VoIP_FaxRelay" value="1" onclick='hideFaxPassthroughCodec(1)'><%ejGetML(MLG_VoIP_SIPServiceProvider_Str36)%>
						</li>
					</ul>
					<ul class="space"></ul>
					<ul id='faxcodec'>
						<li class="all_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str37)%></li>
						<li class="all_table">
							<input type="radio" name="faxPassCodec" value="pcmu"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str38)%>
						</li>
						<li class="all_table">
							<input type="radio" name="faxPassCodec" value="pcma"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str39)%>
						</li>
					</ul>
				</div>
			</li>
			<!--FAX Option END-->
			
			<li class="space"></li>

			<!--QoS Tag START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str40)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str41)%> : </li>
						<li class="right_table">
							<input id="tosByte_Sip" name="tosByte_Sip" type="text" size="2" onchange="rangeCheck(0,63,0,this,1,1)"/><span class="hint">(0-63)</span>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str42)%> : </li>
						<li class="right_table">
							<input id="tosByte_Rtp" name="tosByte_Rtp" type="text" size="2" onchange="rangeCheck(0,63,0,this,1,1)"/><span class="hint">(0-63)</span>
						</li>
					</ul>
				</div>
			</li>
			<!--QoS Tag END-->
			
			<li class="space"></li>

			<!--Timer Setting START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str43)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str44)%> : </li>
						<li class="right_table">
							<input id="reg_ExpTmr" name="reg_ExpTmr" type="text" size="10" onchange="rangeCheck(20,65535,3600,this,1,1)"/><span class="hint">(20-65535) <%ejGetML(MLG_Common_Second)%> </span>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str45)%> : </li>
						<li class="right_table">
							<input id="reg_RetryInt" name="reg_RetryInt" type="text" size="10" onchange="rangeCheck(1,65535,180,this,1,1)"/><span class="hint">(1-65535) <%ejGetML(MLG_Common_Second)%>  </span>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str46)%> : </li>
						<li class="right_table">
							<input id="invite_ExpTmr" name="invite_ExpTmr" type="text" size="10" onchange="rangeCheck(91,3600,180,this,1,1)"/><span class="hint">(91-3600) <%ejGetML(MLG_Common_Second)%>  </span>
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str47)%> : </li>
						<li class="right_table">
							<input id="min_SE" name="min_SE" type="text" size="10"  onchange="rangeCheck(90,1800,120,this,1,1)"/><span class="hint">(90-1800) <%ejGetML(MLG_Common_Second)%>  </span>
						</li>
					</ul>
				</div>
			</li>
			<!--Timer Setting END-->

			<li class="space"></li>

			<!--Phone Key Config START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str48)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str49)%> : </li>
						<li class="right_table">
							<input id="callReturn" name="callReturn" type="text" size="4" maxlength="4" />
						</li>
					</ul>
<!--cathy add start for caller id hidden call -->
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str50)%> : </li>
						<li class="right_table">
							<input id="CallidDisplay" name="CallidDisplay" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str51)%> : </li>
						<li class="right_table">
							<input id="CallerHiddenCall" name="CallerHiddenCall" type="text" size="4" maxlength="4" />
						</li>
					</ul>
<!-- cathy add end-->
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str52)%> : </li>
						<li class="right_table">
							<input id="oneShotCallidDisplay" name="oneShotCallidDisplay" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str53)%> : </li>
						<li class="right_table">
							<input id="oneShotCallerHiddenCall" name="oneShotCallerHiddenCall" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str54)%> : </li>
						<li class="right_table">
							<input id="CallWaitingEnable" name="CallWaitingEnable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str55)%> : </li>
						<li class="right_table">
							<input id="CallWaitingDisable" name="CallWaitingDisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str56)%> : </li>
						<li class="right_table">
							<input id="IVR" name="IVR" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str57)%> : </li>
						<li class="right_table">
							<input id="InternalCall" name="InternalCall" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str58)%> : </li>
						<li class="right_table">
							<input id="CallTransfer" name="CallTransfer" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<!--
					<ul>
						<li class="left_table">Call Park : </li>
						<li class="right_table">
							<input id="CallPark" name="CallPark" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table">Call Park Retreive : </li>
						<li class="right_table">
							<input id="CallParkRetreive" name="CallParkRetreive" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					-->
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str59)%> : </li>
						<li class="right_table">
							<input id="unCallForwardEnable" name="unCallForwardEnable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str60)%> : </li>
						<li class="right_table">
							<input id="unCallForwardDisable" name="unCallForwardDisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str61)%> : </li>
						<li class="right_table">
							<input id="noCallForwardEnable" name="noCallForwardEnable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str62)%> : </li>
						<li class="right_table">
							<input id="noCallForwardDisable" name="noCallForwardDisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str63)%> : </li>
						<li class="right_table">
							<input id="BusyCallForwardEnable" name="BusyCallForwardEnable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str64)%> : </li>
						<li class="right_table">
							<input id="BusyCallForwardDisable" name="BusyCallForwardDisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str65)%> : </li>
						<li class="right_table">
							<input id="oneShotCallWaitingEnable" name="oneShotCallWaitingEnable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str66)%> : </li>
						<li class="right_table">
							<input id="oneShotCallWaitingDisable" name="oneShotCallWaitingDisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str67)%> : </li>
						<li class="right_table">
							<input id="dndenable" name="dndenable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str68)%> : </li>
						<li class="right_table">
							<input id="dnddisable" name="dnddisable" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str69)%> : </li>
						<li class="right_table">
							<input id="ccbsDeactive" name="ccbsDeactive" type="text" size="4" maxlength="4" />
						</li>
					</ul>
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str70)%> : </li>
						<li class="right_table">
							<input id="outgoingSip" name="outgoingSip" type="text" size="4" maxlength="4" />
						</li>
					</ul>
				</div>
			</li>
			<!--Phone Key Config END-->

			<li class="space"></li>
		
			<!--Dial Plan START-->
			<li class="set1" >
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str71)%>Dial Plan</div>
				<div class="w_text3">
					<ul>
						<li class="left_table">
							<input type='checkbox' size="10" name='dialPlanEnable' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str71)%> <%ejGetML(MLG_Common_Enable)%>
						</li>
					</ul>
					<ul>
						<li class="right_table">
							<textarea id="iddialPlan" name="dialPlan" wrap="VIRTUAL" rows="5" cols="40" style="width:95%" onBlur="checkchars(this,512)"> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str72)%></textarea>
						</li>
					</ul>
				</div>
			</li>
			<!--Dial Plan END-->
			
			<li class="space"></li>

			<!--Dialing Interval Selection START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str73)%></div>
				<div class="w_text">
					<ul>
						<li class="left_table"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str73)%> : </li>
						<li class="right_table">
							<select id="dialingIntervalTime" name="dialingIntervalTime">
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3" selected="selected">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
								<option value="9">9</option>
								<option value="10">10</option>
							</select>
							<span class="hint"><%ejGetML(MLG_Common_Second)%></span>
						</li>
					</ul>
				</div>
			</li>
			<!--Dialing Interval Selection END-->

			<li class="space"> </li>

			<!--Immediate Dial Enable START-->
			<li class="set1">
				<div class="title"><%ejGetML(MLG_VoIP_SIPServiceProvider_Str74)%></div>
				<div class="w_text">
					<input type='checkbox' size="10" name='pound_Enable' id='pound_Enable' /> <%ejGetML(MLG_VoIP_SIPServiceProvider_Str74)%>
				</div>
			</li>
			<!--Immediate Dial Enable END-->

		</div>
	
		<li class="space"> </li>
	</ul>
</div>
</div>
</form>
