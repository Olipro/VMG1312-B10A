<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>SAMBA Developers Guide</title><link rel="stylesheet" href="../samba.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><meta name="description" content="Last Update : Fri Oct 10 00:59:58 CEST 2003 This book is a collection of documents that might be useful for people developing samba or those interested in doing so. It's nothing more than a collection of documents written by samba developers about the internals of various parts of samba and the SMB protocol. It's still (and will always be) incomplete. The most recent version of this document can be found at http://devel.samba.org/. This documentation is distributed under the GNU General Public License (GPL) version 2. A copy of the license is included with the Samba source distribution. A copy can be found on-line at http://www.fsf.org/licenses/gpl.txt This document is incomplete and unmaintained. It is merely a collection of development-related notes."><link rel="start" href="index.html" title="SAMBA Developers Guide"><link rel="next" href="pr01.html" title="Attribution"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">SAMBA Developers Guide</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="pr01.html">Next</a></td></tr></table><hr></div><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="Samba-Developers-Guide"></a>SAMBA Developers Guide</h1></div><div><div class="authorgroup"><div class="editor"><h4 class="editedby">Edited by</h4><h3 class="editor"><span class="firstname">Jelmer</span> <span class="othername">R.</span> <span class="surname">Vernooij</span></h3><div class="affiliation"><span class="orgname">The Samba Team<br></span><div class="address"><p><code class="email">&lt;<a class="email" href="mailto:jelmer@samba.org">jelmer@samba.org</a>&gt;</code></p></div></div></div></div></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
<span class="emphasis"><em>Last Update</em></span> : Fri Oct 10 00:59:58 CEST 2003
</p><p>
This book is a collection of documents that might be useful for 
people developing samba or those interested in doing so.
It's nothing more than a collection of documents written by samba developers about 
the internals of various parts of samba and the SMB protocol. It's still (and will always be) incomplete.
The most recent version of this document
can be found at <a class="ulink" href="http://devel.samba.org/" target="_top">http://devel.samba.org/</a>.
</p><p>
This documentation is distributed under the GNU General Public License (GPL) 
version 2.  A copy of the license is included with the Samba source
distribution.  A copy can be found on-line at <a class="ulink" href="http://www.fsf.org/licenses/gpl.txt" target="_top">http://www.fsf.org/licenses/gpl.txt</a>
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>This document is incomplete and unmaintained. It is merely a 
	collection of development-related notes.</p></div></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="preface"><a href="pr01.html">Attribution</a></span></dt><dt><span class="part"><a href="pt01.html">I. The protocol</a></span></dt><dd><dl><dt><span class="chapter"><a href="unix-smb.html">1. NetBIOS in a Unix World</a></span></dt><dd><dl><dt><span class="sect1"><a href="unix-smb.html#id2527397">Introduction</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2523252">Usernames</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2523584">File Ownership</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2523615">Passwords</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2522475">Locking</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2522527">Deny Modes</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2522558">Trapdoor UIDs</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2522579">Port numbers</a></span></dt><dt><span class="sect1"><a href="unix-smb.html#id2575507">Protocol Complexity</a></span></dt></dl></dd><dt><span class="chapter"><a href="ntdomain.html">2. NT Domain RPC's</a></span></dt><dd><dl><dt><span class="sect1"><a href="ntdomain.html#id2575626">Introduction</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2575791">Sources</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2575818">Credits</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2575850">Notes and Structures</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2575855">Notes</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2575918">Enumerations</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2576080">Structures</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2578353">MSRPC over Transact Named Pipe</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2578363">MSRPC Pipes</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2578447">Header</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579120">Tail</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579156">RPC Bind / Bind Ack</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579294">NTLSA Transact Named Pipe</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579422">LSA Open Policy</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579518">LSA Query Info Policy</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579600">LSA Enumerate Trusted Domains</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579670">LSA Open Secret</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579753">LSA Close</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579804">LSA Lookup SIDS</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2579965">LSA Lookup Names</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2580137">NETLOGON rpc Transact Named Pipe</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2580263">LSA Request Challenge</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2580372">LSA Authenticate 2</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2580487">LSA Server Password Set</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2580578">LSA SAM Logon</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2580658">LSA SAM Logoff</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2580729">\\MAILSLOT\NET\NTLOGON</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2580743">Query for PDC</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2580944">SAM Logon</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2581194">SRVSVC Transact Named Pipe</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2581228">Net Share Enum</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2581396">Net Server Get Info</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2581485">Cryptographic side of NT Domain Authentication</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2581491">Definitions</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2581617">Protocol</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2581696">Comments</a></span></dt></dl></dd><dt><span class="sect1"><a href="ntdomain.html#id2581738">SIDs and RIDs</a></span></dt><dd><dl><dt><span class="sect2"><a href="ntdomain.html#id2581770">Well-known SIDs</a></span></dt><dt><span class="sect2"><a href="ntdomain.html#id2582008">Well-known RIDS</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="part"><a href="pt02.html">II. Samba Basics</a></span></dt><dd><dl><dt><span class="chapter"><a href="architecture.html">3. Samba Architecture</a></span></dt><dd><dl><dt><span class="sect1"><a href="architecture.html#id2582232">Introduction</a></span></dt><dt><span class="sect1"><a href="architecture.html#id2582275">Multithreading and Samba</a></span></dt><dt><span class="sect1"><a href="architecture.html#id2582307">Threading smbd</a></span></dt><dt><span class="sect1"><a href="architecture.html#id2582368">Threading nmbd</a></span></dt><dt><span class="sect1"><a href="architecture.html#id2582413">nbmd Design</a></span></dt></dl></dd><dt><span class="chapter"><a href="debug.html">4. The samba DEBUG system</a></span></dt><dd><dl><dt><span class="sect1"><a href="debug.html#id2582469">New Output Syntax</a></span></dt><dt><span class="sect1"><a href="debug.html#id2582578">The DEBUG() Macro</a></span></dt><dt><span class="sect1"><a href="debug.html#id2582684">The DEBUGADD() Macro</a></span></dt><dt><span class="sect1"><a href="debug.html#id2582720">The DEBUGLVL() Macro</a></span></dt><dt><span class="sect1"><a href="debug.html#id2582810">New Functions</a></span></dt><dd><dl><dt><span class="sect2"><a href="debug.html#id2582816">dbgtext()</a></span></dt><dt><span class="sect2"><a href="debug.html#id2582832">dbghdr()</a></span></dt><dt><span class="sect2"><a href="debug.html#id2582851">format_debug_text()</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="internals.html">5. Samba Internals</a></span></dt><dd><dl><dt><span class="sect1"><a href="internals.html#id2582902">Character Handling</a></span></dt><dt><span class="sect1"><a href="internals.html#id2582924">The new functions</a></span></dt><dt><span class="sect1"><a href="internals.html#id2583053">Macros in byteorder.h</a></span></dt><dd><dl><dt><span class="sect2"><a href="internals.html#id2583063">CVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583074">PVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583085">SCVAL(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583096">SVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583108">IVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583120">SVALS(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583131">IVALS(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583142">SSVAL(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583154">SIVAL(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583165">SSVALS(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583177">SIVALS(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583188">RSVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583200">RIVAL(buf,pos)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583211">RSSVAL(buf,pos,val)</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583223">RSIVAL(buf,pos,val)</a></span></dt></dl></dd><dt><span class="sect1"><a href="internals.html#id2583235">LAN Manager Samba API</a></span></dt><dd><dl><dt><span class="sect2"><a href="internals.html#id2583263">Parameters</a></span></dt><dt><span class="sect2"><a href="internals.html#id2583388">Return value</a></span></dt></dl></dd><dt><span class="sect1"><a href="internals.html#id2583458">Code character table</a></span></dt></dl></dd><dt><span class="chapter"><a href="CodingSuggestions.html">6. Coding Suggestions</a></span></dt><dt><span class="chapter"><a href="contributing.html">7. Contributing code</a></span></dt><dt><span class="chapter"><a href="modules.html">8. Modules</a></span></dt><dd><dl><dt><span class="sect1"><a href="modules.html#id2584110">Advantages</a></span></dt><dt><span class="sect1"><a href="modules.html#id2584148">Loading modules</a></span></dt><dd><dl><dt><span class="sect2"><a href="modules.html#id2584174">Static modules</a></span></dt><dt><span class="sect2"><a href="modules.html#id2584206">Shared modules</a></span></dt></dl></dd><dt><span class="sect1"><a href="modules.html#id2584230">Writing modules</a></span></dt><dd><dl><dt><span class="sect2"><a href="modules.html#id2584279">Static/Shared selection in configure.in</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="part"><a href="pt03.html">III. Samba Subsystems</a></span></dt><dd><dl><dt><span class="chapter"><a href="rpc-plugin.html">9. RPC Pluggable Modules</a></span></dt><dd><dl><dt><span class="sect1"><a href="rpc-plugin.html#id2584438">About</a></span></dt><dt><span class="sect1"><a href="rpc-plugin.html#id2584453">General Overview</a></span></dt></dl></dd><dt><span class="chapter"><a href="vfs.html">10. VFS Modules</a></span></dt><dd><dl><dt><span class="sect1"><a href="vfs.html#id2584615">The Samba (Posix) VFS layer</a></span></dt><dd><dl><dt><span class="sect2"><a href="vfs.html#id2584656">The general interface</a></span></dt><dt><span class="sect2"><a href="vfs.html#id2584968">Possible VFS operation layers</a></span></dt></dl></dd><dt><span class="sect1"><a href="vfs.html#id2585029">The Interaction between the Samba VFS subsystem and the modules</a></span></dt><dd><dl><dt><span class="sect2"><a href="vfs.html#id2585035">Initialization and registration</a></span></dt><dt><span class="sect2"><a href="vfs.html#id2585180">How the Modules handle per connection data</a></span></dt></dl></dd><dt><span class="sect1"><a href="vfs.html#id2585381">Upgrading to the New VFS Interface</a></span></dt><dd><dl><dt><span class="sect2"><a href="vfs.html#id2585387">Upgrading from 2.2.* and 3.0aplha modules</a></span></dt></dl></dd><dt><span class="sect1"><a href="vfs.html#id2585791">Some Notes</a></span></dt><dd><dl><dt><span class="sect2"><a href="vfs.html#id2585797">Implement TRANSPARENT functions</a></span></dt><dt><span class="sect2"><a href="vfs.html#id2585816">Implement OPAQUE functions</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="parsing.html">11. The smb.conf file</a></span></dt><dd><dl><dt><span class="sect1"><a href="parsing.html#id2585873">Lexical Analysis</a></span></dt><dd><dl><dt><span class="sect2"><a href="parsing.html#id2585945">Handling of Whitespace</a></span></dt><dt><span class="sect2"><a href="parsing.html#id2585990">Handling of Line Continuation</a></span></dt><dt><span class="sect2"><a href="parsing.html#id2586042">Line Continuation Quirks</a></span></dt></dl></dd><dt><span class="sect1"><a href="parsing.html#id2586119">Syntax</a></span></dt><dd><dl><dt><span class="sect2"><a href="parsing.html#id2586176">About params.c</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="wins.html">12. Samba WINS Internals</a></span></dt><dd><dl><dt><span class="sect1"><a href="wins.html#id2586214">WINS Failover</a></span></dt></dl></dd><dt><span class="chapter"><a href="pwencrypt.html">13. LanMan and NT Password Encryption</a></span></dt><dd><dl><dt><span class="sect1"><a href="pwencrypt.html#id2586332">Introduction</a></span></dt><dt><span class="sect1"><a href="pwencrypt.html#id2586353">How does it work?</a></span></dt><dt><span class="sect1"><a href="pwencrypt.html#id2586436">The smbpasswd file</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="pt04.html">IV. Debugging and tracing</a></span></dt><dd><dl><dt><span class="chapter"><a href="tracing.html">14. Tracing samba system calls</a></span></dt><dt><span class="chapter"><a href="devprinting.html">15. Samba Printing Internals</a></span></dt><dd><dl><dt><span class="sect1"><a href="devprinting.html#id2586922">Abstract</a></span></dt><dt><span class="sect1"><a href="devprinting.html#id2586935">
Printing Interface to Various Back ends
</a></span></dt><dt><span class="sect1"><a href="devprinting.html#id2587011">
Print Queue TDB's
</a></span></dt><dt><span class="sect1"><a href="devprinting.html#id2587185">
ChangeID and Client Caching of Printer Information
</a></span></dt><dt><span class="sect1"><a href="devprinting.html#id2587195">
Windows NT/2K Printer Change Notify
</a></span></dt></dl></dd></dl></dd><dt><span class="part"><a href="pt05.html">V. Appendices</a></span></dt><dd><dl><dt><span class="chapter"><a href="Packaging.html">16. Notes to packagers</a></span></dt><dd><dl><dt><span class="sect1"><a href="Packaging.html#id2587515">Versioning</a></span></dt><dt><span class="sect1"><a href="Packaging.html#id2587541">Modules</a></span></dt></dl></dd></dl></dd></dl></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="pr01.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> Attribution</td></tr></table></div></body></html>
